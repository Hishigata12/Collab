<!-- index.html -->
<!DOCTYPE html>
<html>
  <head>
    <title>Chat</title>
    <link rel="stylesheet" href="/css/message.css">
  </head>
  <body>
    <!-- <ul id="messages"></ul>
    <input id="messageInput" autocomplete="off" />
    <button onclick="sendMessage()">Send</button> -->
    <!-- Floating Chat UI -->
  <!-- <div id="chat-container">
    <div id="chat-header" onclick="toggleChat()">ðŸ’¬ Chat</div>
    <div id="chat-body" class="hidden">
      <div id="chat-messages"></div>
      <input id="chat-to" placeholder="Recipient username" />
      <input id="chat-input" autocomplete='off' placeholder="Type a message..." />
      <button id="send-msg">Send</button>
    </div>
  </div> -->
  
<div id="chat-widget">
  <div class="chat-header" onclick="toggleChat2()">
    <span>Messages</span>
    <button id="new-chat-toggle" onclick="toggleChat()" hidden>New Chat</button>
  </div>
  <div id="chat-body" class="chat-body hidden">
    <div id="chat-window">
      <div id="chat-partner">Send to...</div>
      <div id="chat-messages"></div>
      <textarea id="chat-input" type="text" placeholder="Type a message..."></textarea>
    </div>
    <div id="new-chat-box" class="scrollable-siderbar">
      <div id="conversation-list"></div>
      <input id="new-chat-user" type="text" placeholder="Enter username..." />
      <button id="start-chat-btn">Start</button>
    </div>
  </div>
</div>


  <!-- <script src="/node_modules/socket.io/client-dist/socket.io.min.js"></script> -->
  <script src="https://cdn.socket.io/4.8.1/socket.io.min.js"></script>
  <script src='/js/message.js'></script>
  <!-- <script>
    const socket = io();

    const sendMsg = document.getElementById('send-msg')

    sendMsg.addEventListener('click', function() {
      const to = document.getElementById('chat-to')
      const message = document.getElementById('chat-input')
      sendMessage(to.value, message.value)
    })
    
    const messagesDiv = document.getElementById('chat-messages');

    function toggleChat() {
      document.getElementById('chat-body').classList.toggle('hidden');
    }

    function sendChatMessage() {
      const to = document.getElementById('chat-to').value.trim();
      const text = document.getElementById('chat-input').value.trim();
      if (to && text) {
        socket.emit('private message', { to, message: text });
        appendChatMessage('Me', text);
        document.getElementById('chat-input').value = '';
      } 
    }

    function appendChatMessage(from, message) {
      const p = document.createElement('p');
      p.innerHTML = `<strong>${from}:</strong> ${message}`;
      messagesDiv.appendChild(p);
      messagesDiv.scrollTop = messagesDiv.scrollHeight;
    }

    // Listen for private messages
    socket.on('private message', ({ from, message }) => {
      appendChatMessage(from, message);
      // console.log(`Message from ${from}: ${message}`);
      // You can append this to a chat box
    });

    // Send a private message
    function sendMessage(toUser, text) {
      socket.emit('private message', {
        to: toUser,
        message: text
      });
    }
  // </script> -->
  </body>
</html>